import{j as e,A as M,m as b}from"./vendor-ui-B2A3YeRo.js";import{a as l}from"./vendor-react-CTBdW232.js";import{m as S,u as z,a as A,b as O,C as $,T as B}from"./FormField-Boi-LoQB.js";import{a as I,u as P,b as L,T as W}from"./index-CY7Hya_3.js";const Q={hidden:{opacity:0},visible:{opacity:1}},U={hidden:{opacity:0,scale:.95,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",damping:25,stiffness:300}},exit:{opacity:0,scale:.95,y:20,transition:{duration:.2}}},D=({isOpen:v,onClose:m,title:g,children:o,footer:c,size:h="md",showCloseButton:y=!0})=>{const u={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[h];return e.jsx(M,{mode:"wait",children:v&&e.jsxs(l.Fragment,{children:[e.jsx(b.div,{variants:Q,initial:"hidden",animate:"visible",exit:"hidden",onClick:m,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:e.jsxs(b.div,{variants:U,initial:"hidden",animate:"visible",exit:"exit",className:`${u} w-full bg-white rounded-lg shadow-xl`,onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:g}),y&&e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"px-6 py-4",children:o}),c&&e.jsx("div",{className:"px-6 py-4 border-t bg-gray-50 rounded-b-lg",children:c})]})})]})})},F=()=>{const{state:v}=I(),{answers:m,sections:g,questions:o}=v,c=l.useMemo(()=>S(r=>r.filter(s=>s.isMandatory)),[]),h=l.useMemo(()=>S((r,s)=>r.find(i=>i.id===s)),[]),y=l.useMemo(()=>S((r,s)=>r.find(i=>i.id===s)),[]),u=l.useCallback((r,s,i)=>{const d=new RegExp(`{{\\s*${s}\\s*}}`,"g");return r.replace(d,i)},[]),p=l.useCallback(r=>{let s="";const i=new Set;return r.forEach(d=>{s+=`// --- Section: ${d.title} (Mandatory) ---
`,s+=d.code+`

`,i.add(d.id)}),{code:s,includedIds:i}},[]),j=l.useCallback((r,s,i,d)=>{let t="";return Object.entries(r).forEach(([x,a])=>{const n=h(s,x);if(!n)return;let f;if(n.type==="choice"&&a?(Array.isArray(a)?a:[a]).forEach(k=>{const T=n.options?.find(E=>E.value===k);T?.linkedSectionId&&(f=T.linkedSectionId)}):(n.type==="text"||n.type==="boolean")&&n.linkedSectionId&&(f=n.linkedSectionId),f&&!d.has(f)){const N=y(i,f);if(N){let k=N.code;n.type==="text"&&n.placeholderVariable&&typeof a=="string"&&(k=u(k,n.placeholderVariable,a)),t+=`// --- Section: ${N.title} (Linked by: ${n.text.substring(0,20)}...) ---
`,t+=k+`

`,d.add(N.id)}}else n.type==="text"&&n.placeholderVariable&&typeof a=="string"&&!f&&(t+=`// User input for "${n.text.substring(0,20)}...": ${a}

`)}),t},[h,y,u]),w=l.useMemo(()=>{const r=c(g),{code:s,includedIds:i}=p(r),d=j(m,o,g,i);return(s+d).trim()||"// No code generated yet. Answer questions or mark sections as mandatory."},[m,g,o,c,p,j]);return e.jsxs("div",{className:"sticky top-4 h-[calc(100vh-2rem)] overflow-hidden rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Live Code Preview"})}),e.jsx("pre",{className:"p-4 overflow-auto h-[calc(100%-41px)] bg-white dark:bg-gray-900 text-sm text-gray-800 dark:text-gray-200 font-mono",children:e.jsx("code",{children:w})})]})},R={initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{staggerChildren:.1}}},C={initial:{opacity:0,y:10},animate:{opacity:1,y:0}},H=()=>{const{getBannerImage:v,getScannerImages:m}=z();P();const{theme:g}=L(),{state:o,dispatch:c}=I(),{questions:h}=A(),{sections:y}=O(),[u,p]=l.useState(null),[j,w]=l.useState("");l.useEffect(()=>{c({type:"SET_QUESTIONS",payload:h})},[h,c]),l.useEffect(()=>{c({type:"SET_SECTIONS",payload:y})},[y,c]);const r=v(),s=m();l.useEffect(()=>{console.log("Scanner Images:",s)},[s]);const i=(t,x)=>{c({type:"SET_ANSWER",payload:{questionId:t,value:x}})},d=t=>{const x=o.answers[t.id];switch(t.type){case"text":return e.jsx(B,{label:t.text,value:x||"",onChange:a=>i(t.id,a.target.value),required:t.required,className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"});case"choice":return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.text," ",t.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.options?.map(a=>e.jsxs("label",{className:`
                    flex flex-col items-center p-4 border rounded-lg cursor-pointer
                    transition-all duration-150 ease-in-out
                    ${x===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 ring-2 ring-blue-500":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700"}
                  `,children:[e.jsx("input",{type:"radio",name:t.id,value:a.value,checked:x===a.value,onChange:()=>i(t.id,a.value),className:"sr-only"}),a.imageUrl&&e.jsx("img",{src:a.imagePreview||a.imageUrl,alt:a.text,className:"w-full h-32 object-contain mb-2 rounded",style:{transform:`scale(${a.scale||1})`}}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white text-center",children:a.text})]},a.id))})]});case"boolean":return e.jsx($,{label:t.text,checked:!!x,onChange:a=>i(t.id,a.target.checked),required:t.required});default:return null}};return e.jsx("div",{className:g==="dark"?"dark":"",children:e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors duration-200",children:[e.jsx(W,{}),e.jsxs(b.div,{variants:R,initial:"initial",animate:"animate",className:"relative",children:[e.jsx(b.div,{variants:C,className:"py-12 px-4 text-center",children:e.jsx("h1",{className:"text-5xl md:text-6xl lg:text-7xl font-bold text-gray-900 dark:text-white font-display tracking-tight",children:"COMET Scanner Template Wizard"})}),e.jsx(b.div,{variants:C,className:"relative w-full mb-12 bg-gray-100 dark:bg-gray-800",children:r?e.jsx("div",{className:"relative w-full flex items-center justify-center overflow-hidden",children:e.jsx("div",{className:"w-full",style:{paddingBottom:"42.85%"},children:e.jsx("img",{src:r.src,alt:"COMET Scanner Banner",className:"absolute top-0 left-0 w-full h-full object-contain transition-transform duration-300",style:{transform:`scale(${r.scale||1})`,transformOrigin:"center center"}})})}):e.jsx("div",{className:"w-full",style:{paddingBottom:"42.85%"},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl text-white font-semibold",children:"Visualize Your Data with COMET Scanner"})})})}),s.length>0&&e.jsxs(b.div,{variants:C,className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-8 text-center",children:"Scanner Variations"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(t=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden cursor-pointer transform transition-transform hover:scale-105",onClick:()=>{p(t.src),w(t.displayText||"Scanner Variation")},children:[e.jsx("div",{className:"aspect-video bg-gray-100 dark:bg-gray-700 relative overflow-hidden",children:e.jsx("img",{src:t.src,alt:t.alt,className:"w-full h-full object-contain",style:{transform:`scale(${t.scale||1})`}})}),t.displayText&&e.jsx("div",{className:"p-4",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.displayText})})]},t.id))})]}),e.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-16 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:e.jsxs(b.div,{variants:C,children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Configure Your Template"}),e.jsxs("div",{className:"space-y-6",children:[o.questions.map(t=>e.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:d(t)},t.id)),o.questions.length===0&&e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No questions configured yet. Please set them up in the Admin Dashboard."})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(F,{})})]})]}),u&&e.jsx(D,{isOpen:!0,onClose:()=>{p(null),w("")},title:j,size:"xl",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex justify-center items-center bg-white dark:bg-gray-800 rounded-lg p-4",children:e.jsx("img",{src:u,alt:j,className:"max-w-full max-h-[80vh] object-contain"})})})})]})})};export{H as default};
