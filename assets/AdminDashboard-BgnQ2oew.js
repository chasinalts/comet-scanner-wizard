import{j as e,m as n,A as R,R as M,a as L}from"./vendor-ui-B2A3YeRo.js";import{a as k,e as z}from"./vendor-react-CTBdW232.js";import{L as P,u as V,c as W,b as Y}from"./index-CMXC3hw9.js";import{u as G,a as _,T as O,C as T,b as U,S as B,h as H}from"./FormField-DjtN2c4a.js";const p=k.forwardRef(({children:y,variant:l="primary",size:g="md",isLoading:d=!1,loadingText:u,leftIcon:o,rightIcon:c,fullWidth:x=!1,disabled:v,className:h="",...b},C)=>{const j="inline-flex items-center justify-center font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors",S={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-gray-600 hover:bg-gray-100 focus:ring-gray-500"},D={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return e.jsx(n.button,{ref:C,whileTap:{scale:.98},disabled:v||d,className:`
          ${j}
          ${S[l]}
          ${D[g]}
          ${x?"w-full":""}
          ${v||d?"opacity-60 cursor-not-allowed pointer-events-none":""}
          ${h}
        `,...b,children:d?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:"sm",color:l==="secondary"||l==="ghost"?"gray":"white"}),u&&e.jsx("span",{className:"ml-2",children:u})]}):e.jsxs(e.Fragment,{children:[o&&e.jsx("span",{className:"mr-2",children:o}),y,c&&e.jsx("span",{className:"ml-2",children:c})]})})});p.displayName="Button";const J=k.forwardRef(({children:y,size:l="md",...g},d)=>{const u={sm:"p-1.5",md:"p-2",lg:"p-3"};return e.jsx(p,{ref:d,size:l,className:u[l],...g,children:y})});J.displayName="IconButton";const K=()=>e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},className:"relative w-8 h-8",children:e.jsx(n.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"absolute inset-0 border-2 border-blue-500 dark:border-blue-400 rounded-full border-t-transparent"})}),X=()=>e.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),Z=()=>e.jsx(n.svg,{initial:{scale:1},animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0},className:"w-8 h-8 text-blue-500 dark:text-blue-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m0-16l-4 4m4-4l4 4"})}),q=()=>e.jsx(n.svg,{initial:{scale:0},animate:{scale:1},className:"w-8 h-8 text-red-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});function ee({onFileSelect:y,accept:l="image/*",maxSize:g=5,title:d="Upload File",description:u="Drag and drop a file here, or click to select",variant:o="default",isLoading:c=!1}){const[x,v]=k.useState(!1),[h,b]=k.useState(null),C=z.useRef(null),j=m=>m.size>g*1024*1024?{type:"size",message:`File size exceeds ${g}MB limit`}:!l.includes("*")&&!l.includes(m.type)?{type:"type",message:"Invalid file type"}:null,S=k.useCallback(m=>{if(m.preventDefault(),v(!1),b(null),c)return;const f=m.dataTransfer.files[0];if(f){const N=j(f);if(N){b(N);return}y(f)}},[y,g,l,c]),D=k.useCallback(m=>{m.preventDefault(),c||(v(!0),b(null))},[c]),I=k.useCallback(m=>{m.preventDefault(),v(!1)},[]),A=()=>{c||(b(null),C.current?.click())},Q=m=>{if(c)return;const f=m.target.files?.[0];if(f){const N=j(f);if(N){b(N);return}y(f)}m.target.value=""},w=o==="compact";return e.jsxs(n.div,{onClick:A,onDrop:S,onDragOver:D,onDragLeave:I,initial:{opacity:0},animate:{opacity:1,borderColor:x?"#3B82F6":h?"#EF4444":void 0,scale:x?1.02:1},transition:{duration:.2},className:`
        relative cursor-pointer
        ${w?"p-3":"p-6"}
        rounded-lg border-2 border-dashed
        ${c?"cursor-wait ":""}
        ${h?"border-red-500 bg-red-50 dark:bg-red-900/20":x?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}
        transition-colors duration-200
      `,children:[e.jsx("input",{ref:C,type:"file",accept:l,onChange:Q,className:"hidden",disabled:c}),e.jsx(R,{mode:"wait",children:c?e.jsxs(n.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-white/50 dark:bg-gray-800/50 rounded-lg backdrop-blur-sm",children:[e.jsx(K,{}),e.jsx(n.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-blue-500 dark:text-blue-400 font-medium mt-2",children:"Uploading..."})]},"loading"):h?e.jsxs(n.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-red-50/50 dark:bg-red-900/30 rounded-lg backdrop-blur-sm",children:[e.jsx(q,{}),e.jsxs(n.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-red-500 dark:text-red-400 font-medium text-center",children:[h.message,e.jsx("p",{className:"text-sm mt-1 text-red-400 dark:text-red-300",children:"Click or drag a new file to try again"})]})]},"error"):x?e.jsxs(n.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 flex flex-col items-center justify-center bg-blue-50/50 dark:bg-blue-900/30 rounded-lg backdrop-blur-sm",children:[e.jsx(Z,{}),e.jsx(n.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"text-blue-500 dark:text-blue-400 font-medium",children:"Drop to upload"})]},"dragging"):e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`text-center ${w?"space-y-1":"space-y-2"}`,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(X,{}),e.jsx("div",{className:`${w?"text-sm":"text-base"} font-medium text-gray-900 dark:text-white`,children:d}),e.jsx("p",{className:`${w?"text-xs":"text-sm"} text-gray-500 dark:text-gray-400`,children:u}),e.jsxs("p",{className:`${w?"text-xs":"text-sm"} text-gray-400 dark:text-gray-500`,children:["Max size: ",g,"MB"]})]})},"normal")})]})}function ie(){const{currentUser:y}=V(),{showToast:l}=W(),{theme:g}=Y(),{questions:d,addQuestion:u,updateQuestion:o,deleteQuestion:c}=G(),{sections:x,addSection:v,updateSection:h,deleteSection:b,reorderSections:C}=_(),[j,S]=k.useState(null),D=a=>{const t=d.find(s=>s.id===a);if(!t)return;const r={id:`option-${Date.now()}`,text:"",value:"",scale:1};o(a,{options:[...t.options||[],r]}),l("success","New answer option added")},I=(a,t)=>r=>{const s=d.find(i=>i.id===a);s&&o(a,{options:s.options?.map(i=>i.id===t?{...i,text:r.target.value,value:r.target.value.toLowerCase()}:i)})},A=(a,t)=>r=>{const s=d.find(i=>i.id===a);s&&o(a,{options:s.options?.map(i=>i.id===t?{...i,scale:parseFloat(r.target.value)}:i)})},Q=async(a,t,r)=>{if(j){l("error","Please wait for the current upload to complete");return}try{S({questionId:a,optionId:t}),await new Promise(s=>{H(r,(i,E)=>{const F=d.find($=>$.id===a);F&&(o(a,{options:F.options?.map($=>$.id===t?{...$,imageUrl:i,imagePreview:E,scale:1}:$)}),s())})}),l("success","Image uploaded successfully")}catch{l("error","Failed to upload image")}finally{S(null)}},w=(a,t)=>{const r=d.find(s=>s.id===a);r&&(o(a,{options:r.options?.map(s=>s.id===t?{...s,imageUrl:void 0,imagePreview:void 0,scale:void 0}:s)}),l("success","Image removed"))},m=(a,t)=>r=>{const s=d.find(i=>i.id===a);s&&o(a,{options:s.options?.map(i=>i.id===t?{...i,linkedSectionId:r.target.value||void 0}:i)})},f=a=>t=>{o(a,{linkedSectionId:t.target.value||void 0})},N=a=>t=>{o(a,{placeholderVariable:t.target.value})};return y?.isOwner?e.jsxs("div",{className:`max-w-7xl mx-auto p-6 space-y-12 ${g==="dark"?"dark":""}`,children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-gray-900 dark:text-white",children:"Admin Dashboard"}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Template Builder"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{onClick:v,children:"Add New Section"}),e.jsx(M,{axis:"y",values:x,onReorder:C,className:"space-y-4",children:x.map(a=>e.jsxs(L,{value:a,className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(O,{value:a.title,onChange:t=>h(a.id,{title:t.target.value}),className:"text-lg font-medium text-gray-900 dark:text-white bg-white dark:bg-gray-800",placeholder:"Section Title"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(T,{label:"Mandatory",checked:a.isMandatory,onChange:t=>h(a.id,{isMandatory:t.target.checked})}),e.jsx(p,{variant:"danger",size:"sm",onClick:()=>b(a.id),children:"Delete Section"})]})]}),e.jsx(U,{value:a.code,onChange:t=>h(a.id,{code:t.target.value}),className:"w-full font-mono text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",rows:5,placeholder:"Enter section code here..."})]},a.id))})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Questions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(p,{onClick:()=>u("text"),children:"Add Text Question"}),e.jsx(p,{onClick:()=>u("choice"),children:"Add Choice Question"}),e.jsx(p,{onClick:()=>u("boolean"),children:"Add Yes/No Question"})]}),e.jsx(R,{mode:"popLayout",children:e.jsx(n.div,{className:"space-y-8",children:d.map(a=>e.jsxs(n.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx(U,{value:a.text,onChange:t=>o(a.id,{text:t.target.value}),className:"w-full text-lg font-medium text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",placeholder:"Enter your question..."}),e.jsx(p,{variant:"danger",size:"sm",onClick:()=>c(a.id),className:"ml-4",children:"Delete"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(T,{label:"Required Question",checked:a.required,onChange:t=>o(a.id,{required:t.target.checked})}),(a.type==="text"||a.type==="boolean")&&e.jsxs(B,{label:"Link to Code Section",value:a.linkedSectionId||"",onChange:f(a.id),className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"None"}),x.map(t=>e.jsx("option",{value:t.id,children:t.title||`Section ${t.id}`},t.id))]})]}),a.type==="text"&&e.jsx(O,{label:"Placeholder Variable Name",value:a.placeholderVariable||"",onChange:N(a.id),placeholder:"e.g., {{USER_INPUT}}",className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 mb-6"}),a.type==="choice"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Answer Options"}),e.jsx(p,{onClick:()=>D(a.id),children:"Add Option"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(R,{mode:"popLayout",children:a.options?.map(t=>e.jsx(n.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"group border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(O,{label:"Option Text",value:t.text,onChange:I(a.id,t.id),placeholder:"Enter answer option text",className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),e.jsxs(B,{label:"Link to Code Section",value:t.linkedSectionId||"",onChange:m(a.id,t.id),className:"text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"None"}),x.map(r=>e.jsx("option",{value:r.id,children:r.title||`Section ${r.id}`},r.id))]}),e.jsx("div",{className:"pt-4",children:t.imageUrl?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative aspect-video bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:e.jsx("img",{src:t.imagePreview||t.imageUrl,alt:t.text||"Option image",className:"w-full h-full object-contain",style:{transform:`scale(${t.scale||1})`}})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Image Scale (",((t.scale||1)*100).toFixed(0),"%)"]}),e.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:t.scale||1,onChange:A(a.id,t.id),className:"w-full"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{variant:"danger",size:"sm",onClick:()=>w(a.id,t.id),children:"Remove Image"})})]}):e.jsx(ee,{onFileSelect:r=>Q(a.id,t.id,r),accept:"image/*",title:"Add Answer Image",description:"Drag and drop or click to upload",maxSize:2,variant:"compact",isLoading:j?.questionId===a.id&&j?.optionId===t.id})})]})},t.id))})})]})]},a.id))})})]})]})]}):e.jsx("div",{className:"p-8 text-center text-gray-900 dark:text-white",children:"You don't have permission to access this page."})}export{ie as default};
