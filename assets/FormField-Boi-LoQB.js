var j=Object.defineProperty;var N=(t,e,n)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var p=(t,e,n)=>N(t,typeof e!="symbol"?e+"":e,n);import{a as l}from"./vendor-react-CTBdW232.js";import{j as u,m as v}from"./vendor-ui-B2A3YeRo.js";class C{constructor(e=100){p(this,"cache");p(this,"maxSize");this.cache=new Map,this.maxSize=e}get(e){const n=this.cache.get(e);if(n){if(n.expiry&&Date.now()>n.expiry){this.cache.delete(e);return}return this.cache.delete(e),this.cache.set(e,n),n.value}}set(e,n,i=null){if(this.cache.size>=this.maxSize){const o=this.cache.keys().next().value;o&&this.cache.delete(o)}const a=i?Date.now()+i:null;this.cache.set(e,{value:n,expiry:a})}clear(){this.cache.clear()}}function g(t,e={}){const{maxCacheSize:n=100,ttl:i=null}=e,a=new C(n),o=(...r)=>{const d=JSON.stringify(r),m=a.get(d);if(m!==void 0)return m;const f=t(...r);return f instanceof Promise?(a.set(d,f,i),f.then(h=>(a.set(d,h,i),h)).catch(h=>{throw a.get(d)===f&&a.set(d,void 0,0),h})):(a.set(d,f,i),f)};return o.clearCache=()=>{a.clear()},o}const T=()=>{const[t,e]=l.useState([]);l.useEffect(()=>{const c=()=>{const x=localStorage.getItem("admin_contents");x&&e(JSON.parse(x))};c();const s=x=>{x.key==="admin_contents"&&c()};return window.addEventListener("storage",s),()=>window.removeEventListener("storage",s)},[]);const n=l.useMemo(()=>g(c=>c.filter(s=>s.type==="banner")),[]),i=l.useCallback(()=>{const c=n(t);if(c.length===0)return null;const s=c[c.length-1];return{id:s.id,src:s.imageUrl||"",alt:s.title,scale:s.scale,displayText:s.displayText}},[t,n]),a=l.useMemo(()=>g(c=>c.filter(s=>s.type==="scanner")),[]),o=l.useMemo(()=>g(c=>[...c].sort((s,x)=>x.updatedAt-s.updatedAt)),[]),r=l.useMemo(()=>g(c=>c.map(s=>({id:s.id,src:s.imageUrl||"",alt:s.title,scale:s.scale,displayText:s.displayText}))),[]),d=l.useCallback(()=>{const c=a(t),s=o(c);return r(s)},[t,a,o,r]),m=l.useMemo(()=>g(c=>c.filter(s=>s.type==="template")),[]),f=l.useMemo(()=>g(c=>c.map(s=>({id:s.id,title:s.title,code:s.content}))),[]),h=l.useCallback(()=>{const c=m(t),s=o(c);return f(s)},[t,m,o,f]),S=l.useMemo(()=>g(c=>c.filter(s=>s.type==="question")),[]),y=l.useMemo(()=>g(c=>c.map(s=>({id:s.id,title:s.title,text:s.content}))),[]),w=l.useCallback(()=>{const c=S(t),s=o(c);return y(s)},[t,S,o,y]);return l.useMemo(()=>({getBannerImage:i,getScannerImages:d,getTemplates:h,getQuestions:w,hasContent:t.length>0}),[i,d,h,w,t.length])},E=(t,e)=>{const n=URL.createObjectURL(t),i=new FileReader;i.onloadend=()=>{const a=i.result;console.log("Image uploaded:",{file:t,imageUrl:a.substring(0,50)+"...",imagePreview:n}),e(a,n)},i.readAsDataURL(t)},Q=t=>{t.startsWith("blob:")&&URL.revokeObjectURL(t)},$=()=>{const[t,e]=l.useState(()=>{const o=localStorage.getItem("admin_questions");return o?JSON.parse(o):[]});return l.useEffect(()=>{localStorage.setItem("admin_questions",JSON.stringify(t))},[t]),l.useEffect(()=>()=>{t.forEach(o=>{o.options?.forEach(r=>{r.imagePreview&&Q(r.imagePreview)})})},[t]),{questions:t,setQuestions:e,addQuestion:o=>{const r={id:`question-${Date.now()}`,type:o,text:"",required:!1,...o==="choice"&&{options:[]},...o==="text"&&{placeholderVariable:""}};e(d=>[...d,r])},updateQuestion:(o,r)=>{e(d=>d.map(m=>m.id===o?{...m,...r}:m))},deleteQuestion:o=>{e(r=>r.filter(d=>d.id!==o))}}},R=()=>{const[t,e]=l.useState(()=>{const r=localStorage.getItem("admin_sections");return r?JSON.parse(r):[]});return l.useEffect(()=>{localStorage.setItem("admin_sections",JSON.stringify(t))},[t]),{sections:t,setSections:e,addSection:()=>{const r={id:`section-${Date.now()}`,title:"New Section",code:"",isMandatory:!1};e(d=>[...d,r])},updateSection:(r,d)=>{e(m=>m.map(f=>f.id===r?{...f,...d}:f))},deleteSection:r=>{e(d=>d.filter(m=>m.id!==r))},reorderSections:r=>{e(r)}}},b=({label:t,error:e,helperText:n,required:i,children:a,fullWidth:o=!1})=>u.jsxs("div",{className:`${o?"w-full":""} space-y-1`,children:[t&&u.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t,i&&u.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),u.jsx("div",{className:"mt-1",children:a}),(e||n)&&u.jsx("div",{className:"mt-1",children:e?u.jsx(v.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-sm text-red-600",children:e}):n?u.jsx("p",{className:"text-sm text-gray-500",children:n}):null})]}),L=({label:t,error:e,helperText:n,required:i,fullWidth:a,...o})=>u.jsx(b,{label:t,error:e,helperText:n,required:i,fullWidth:a,children:u.jsx("input",{className:`
          block rounded-md shadow-sm
          ${a?"w-full":"w-auto"}
          ${e?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}
          disabled:bg-gray-50 disabled:text-gray-500
        `,...o})}),O=({label:t,error:e,helperText:n,required:i,fullWidth:a,...o})=>u.jsx(b,{label:t,error:e,helperText:n,required:i,fullWidth:a,children:u.jsx("textarea",{className:`
          block rounded-md shadow-sm
          ${a?"w-full":"w-auto"}
          ${e?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}
          disabled:bg-gray-50 disabled:text-gray-500
        `,...o})}),z=({label:t,error:e,helperText:n,required:i,fullWidth:a,children:o,...r})=>u.jsx(b,{label:t,error:e,helperText:n,required:i,fullWidth:a,children:u.jsx("select",{className:`
          block rounded-md shadow-sm
          ${a?"w-full":"w-auto"}
          ${e?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}
          disabled:bg-gray-50 disabled:text-gray-500
        `,...r,children:o})}),A=({label:t,error:e,helperText:n,required:i,...a})=>u.jsx(b,{error:e,helperText:n,required:i,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",className:`
            rounded border-gray-300 text-blue-600 shadow-sm
            focus:border-blue-300 focus:ring focus:ring-offset-0 focus:ring-blue-200 focus:ring-opacity-50
            ${e?"border-red-500":""}
          `,...a}),t&&u.jsxs("label",{className:"ml-2 block text-sm text-gray-900",children:[t,i&&u.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]})});export{A as C,z as S,L as T,$ as a,R as b,Q as c,O as d,E as h,g as m,T as u};
