const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-DiOkxBut.js","assets/vendor-react-CSSImZ_M.js","assets/vendor-other-B8UD1HAJ.js","assets/vendor-framer-Cbqpt-xa.js","assets/vendor-supabase-Be-ScRHE.js","assets/Signup-SUCIb6Mq.js","assets/ScannerWizard-CBR4UT8n.js","assets/imageHandlers-CTFMYi5l.js","assets/useImageDB-Cn_3ys7i.js","assets/AdminDashboard-C0uz0YXK.js"])))=>i.map(i=>d[i]);
var Z=Object.defineProperty;var ee=(t,e,r)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var L=(t,e,r)=>ee(t,typeof e!="symbol"?e+"":e,r);import{r as n,j as s,u as R,N as E,a as te,L as z,B as se,R as re,b as I,c as ae,d as oe}from"./vendor-react-CSSImZ_M.js";import{c as ne,_ as v}from"./vendor-supabase-Be-ScRHE.js";import{A as O,m as y}from"./vendor-framer-Cbqpt-xa.js";import"./vendor-other-B8UD1HAJ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const ie=30*60*1e3,U=15*60*1e3,ce=5,W=t=>{const e=localStorage.getItem(`login_attempts_${t}`);if(e){const r=JSON.parse(e);return Date.now()-r.lastAttempt>=U?(localStorage.removeItem(`login_attempts_${t}`),{count:0,lastAttempt:Date.now()}):r}return{count:0,lastAttempt:Date.now()}},le=t=>{const r={count:W(t).count+1,lastAttempt:Date.now()};localStorage.setItem(`login_attempts_${t}`,JSON.stringify(r))},de=t=>{localStorage.removeItem(`login_attempts_${t}`)},V=(t,e)=>{const r=Math.random().toString(36).substring(2),a={username:t,isOwner:e,lastActivity:Date.now(),createdAt:Date.now()};return localStorage.setItem(`session_${r}`,JSON.stringify(a)),r},ue=t=>{const e=localStorage.getItem(`session_${t}`);if(!e)return null;const r=JSON.parse(e);return Date.now()-r.lastActivity>ie?(localStorage.removeItem(`session_${t}`),null):r},me=t=>{localStorage.removeItem(`session_${t}`)},J=()=>{const t="ChasinAlts",e="Chaseburger856!";if(!localStorage.getItem(`user_${t}`)){const r={username:t,password:e,isOwner:!0,createdAt:Date.now(),permissions:{contentManagement:!0,userManagement:!0,systemConfiguration:!0,mediaUploads:!0,securitySettings:!0,siteCustomization:!0}};localStorage.setItem(`user_${t}`,JSON.stringify(r))}},ge=t=>{const e=W(t);return e.count>=ce&&Date.now()-e.lastAttempt<U},q=n.createContext(void 0),P={authenticate:async(t,e)=>{if(ge(t))throw new Error("Account is temporarily locked. Please try again later.");await new Promise(a=>setTimeout(a,1e3));const r=localStorage.getItem(`user_${t}`);if(r){const a=JSON.parse(r);if(a.password===e){de(t);const o=V(t,a.isOwner);localStorage.setItem("current_session_id",o);const{password:i,...c}=a;return c}}throw le(t),new Error("Invalid credentials")},createUser:async(t,e,r)=>{if(await new Promise(c=>setTimeout(c,1e3)),localStorage.getItem(`user_${t}`))throw new Error("Username already exists");const a={username:t,password:e,isOwner:r,createdAt:Date.now(),permissions:r?{contentManagement:!0,userManagement:!0,systemConfiguration:!0,mediaUploads:!0,securitySettings:!0,siteCustomization:!0}:{contentManagement:!1,userManagement:!1,systemConfiguration:!1,mediaUploads:!1,securitySettings:!1,siteCustomization:!1}};localStorage.setItem(`user_${t}`,JSON.stringify(a));const{password:o,...i}=a;return i}};function H({children:t}){const[e,r]=n.useState(null),[a,o]=n.useState(!0);n.useEffect(()=>{J(),(()=>{const x=localStorage.getItem("current_session_id");if(x){const u=ue(x);if(u){const g=localStorage.getItem(`user_${u.username}`);if(g){const h=JSON.parse(g),{password:f,...w}=h;r(w)}}else localStorage.removeItem("current_session_id")}o(!1)})()},[]);const l={currentUser:e,login:async(d,x)=>{try{const u=await P.authenticate(d,x);r(u)}catch(u){throw u}},signup:async(d,x,u)=>{try{const g=await P.createUser(d,x,u);r(g);const h=V(d,u);localStorage.setItem("current_session_id",h)}catch(g){throw g}},logout:async()=>{const d=localStorage.getItem("current_session_id");d&&(me(d),localStorage.removeItem("current_session_id")),r(null)},isLoading:a};return s.jsx(q.Provider,{value:l,children:!a&&t})}function A(){const t=n.useContext(q);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const he={currentStep:1,progress:{step1Complete:!1},answers:{},sections:[],questions:[]},K=n.createContext(void 0);function pe(t,e){switch(e.type){case"SET_STEP":return{...t,currentStep:e.payload};case"SET_PROGRESS":return{...t,progress:{...t.progress,...e.payload}};case"SET_ANSWER":return{...t,answers:{...t.answers,[e.payload.questionId]:e.payload.value}};case"SET_SECTIONS":return{...t,sections:e.payload};case"SET_QUESTIONS":return{...t,questions:e.payload};default:return t}}function xe({children:t}){const[e,r]=n.useReducer(pe,he);return s.jsx(K.Provider,{value:{state:e,dispatch:r},children:t})}function Re(){const t=n.useContext(K);if(t===void 0)throw new Error("useWizard must be used within a WizardProvider");return t}const G=n.createContext(void 0),fe={initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20}},be=({type:t,message:e})=>{const r={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"}[t],a={success:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),error:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),info:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}[t];return s.jsxs(y.div,{variants:fe,initial:"initial",animate:"animate",exit:"exit",className:`${r} text-white p-4 rounded-lg shadow-lg flex items-center space-x-3`,children:[s.jsx("span",{className:"flex-shrink-0",children:a}),s.jsx("p",{className:"text-sm font-medium",children:e})]})},ye=({children:t})=>{const[e,r]=n.useState([]),a=n.useCallback((o,i)=>{const c=Date.now().toString();r(m=>[...m,{id:c,type:o,message:i}]),setTimeout(()=>{r(m=>m.filter(l=>l.id!==c))},5e3)},[]);return s.jsxs(G.Provider,{value:{showToast:a},children:[t,s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.jsx(O,{mode:"popLayout",children:e.map(o=>s.jsx(be,{type:o.type,message:o.message},o.id))})})]})},Ue=()=>{const t=n.useContext(G);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},Q=n.createContext(void 0),we=({children:t})=>{const[e,r]=n.useState(()=>localStorage.getItem("theme")||"dark");n.useEffect(()=>{localStorage.setItem("theme",e),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e)},[e]);const a=()=>{r(o=>o==="dark"?"light":"dark")};return s.jsx(Q.Provider,{value:{theme:e,toggleTheme:a},children:t})},X=()=>{const t=n.useContext(Q);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},Se="https://hpbfipnhqakrhlnhluze.supabase.co",je="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhwYmZpcG5ocWFrcmhsbmhsdXplIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4Mjc0NDgsImV4cCI6MjA2MDQwMzQ0OH0.kPZLOf0rKMn-FjEFgLG_cefIaRaLDdIILSjHzYK-b1w",p=ne(Se,je),We={async addImage(t,e,r="scanner"){try{console.log(`[Supabase DB] Starting to add image with ID: ${t}, Content Type: ${r}`);try{const{count:i,error:c}=await p.from("images").select("id",{count:"exact",head:!0});if(c)throw console.error("[Supabase DB] Error checking images table:",c),new Error(`Database table 'images' not accessible: ${c.message}`);console.log(`[Supabase DB] Images table exists, contains ${i} records`)}catch(i){throw console.error("[Supabase DB] Failed to check images table:",i),new Error(`Failed to access database: ${i.message}`)}const a=e.length;console.log(`[Supabase DB] Image data size: ${(a/1024).toFixed(2)}KB`),a>1e6&&!e.startsWith("http")&&console.warn(`[Supabase DB] Image data is very large (${(a/1024/1024).toFixed(2)}MB), consider using Storage instead`),console.log("[Supabase DB] Storing image data in database...");const{error:o}=await p.from("images").upsert({id:t,image_data:e,content_type:r,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(o)throw console.error("[Supabase DB] Error storing image:",o),o;console.log(`[Supabase DB] Image successfully added/updated with ID: ${t}`)}catch(a){throw console.error(`[Supabase DB] Failed to add/update image ${t}:`,a),a}},async getImage(t){try{const{data:e,error:r}=await p.from("images").select("image_data").eq("id",t).single();if(r)throw r;if(e)return console.log(`[Supabase] Image retrieved for ID: ${t}`),e.image_data;console.warn(`[Supabase] Image not found for ID: ${t}`);return}catch(e){console.error(`[Supabase] Failed to get image ${t}:`,e);return}},async deleteImage(t){try{const{error:e}=await p.from("images").delete().eq("id",t);if(e)throw e;console.log(`[Supabase] Image deleted with ID: ${t}`)}catch(e){throw console.error(`[Supabase] Failed to delete image ${t}:`,e),e}}},Ve={async getContents(t){try{let e=p.from("contents").select("*").order("position",{ascending:!0});t&&(e=e.eq("user_id",t));const{data:r,error:a}=await e;if(a)throw a;return r.map(i=>({id:i.id,title:i.title,content:i.description||"",type:i.type,imageId:i.image_id,position:i.position,scale:i.scale||1,createdAt:new Date(i.created_at).getTime(),updatedAt:new Date(i.updated_at).getTime()}))}catch(e){return console.error("[Supabase] Failed to get contents:",e),[]}},async saveContent(t,e){try{const{error:r}=await p.from("contents").upsert({id:t.id,title:t.title,description:t.content,type:t.type,image_id:t.imageId,position:t.position||0,scale:t.scale||1,user_id:e||null,created_at:new Date(t.createdAt).toISOString(),updated_at:new Date(t.updatedAt).toISOString()});if(r)throw r;console.log(`[Supabase] Content saved with ID: ${t.id}`)}catch(r){throw console.error(`[Supabase] Failed to save content ${t.id}:`,r),r}},async deleteContent(t){try{const{error:e}=await p.from("contents").delete().eq("id",t);if(e)throw e;console.log(`[Supabase] Content deleted with ID: ${t}`)}catch(e){throw console.error(`[Supabase] Failed to delete content ${t}:`,e),e}},async saveContents(t,e){try{const r=t.map(o=>({id:o.id,title:o.title,description:o.content,type:o.type,image_id:o.imageId,position:o.position||0,scale:o.scale||1,user_id:e||null,created_at:new Date(o.createdAt).toISOString(),updated_at:new Date(o.updatedAt).toISOString()})),{error:a}=await p.from("contents").upsert(r);if(a)throw a;console.log(`[Supabase] ${t.length} contents saved`)}catch(r){throw console.error("[Supabase] Failed to save contents:",r),r}}},Je={async uploadImage(t,e){try{console.log(`[Supabase Storage] Starting upload for image ID: ${t}`);const{data:r,error:a}=await p.storage.listBuckets();if(a)throw console.error("[Supabase Storage] Error listing buckets:",a),new Error(`Storage buckets not accessible: ${a.message}`);if(!r.find(c=>c.name==="images"))throw console.error("[Supabase Storage] 'images' bucket not found"),new Error("'images' storage bucket not found. Please create it in the Supabase dashboard.");console.log("[Supabase Storage] 'images' bucket found, proceeding with upload");let i;e.includes("base64,")?(i=e.split("base64,")[1],console.log("[Supabase Storage] Removed data URL prefix")):i=e;try{console.log("[Supabase Storage] Converting base64 to Blob");const c=atob(i),m=[],l=512;for(let h=0;h<c.length;h+=l){const f=c.slice(h,h+l),w=new Array(f.length);for(let b=0;b<f.length;b++)w[b]=f.charCodeAt(b);const D=new Uint8Array(w);m.push(D)}const d=new Blob(m,{type:"image/jpeg"});if(console.log(`[Supabase Storage] Successfully created Blob, size: ${d.size} bytes`),d.size>50*1024*1024)throw new Error(`Image size (${(d.size/1024/1024).toFixed(2)}MB) exceeds the 50MB limit`);console.log("[Supabase Storage] Uploading to Supabase Storage...");const{data:x,error:u}=await p.storage.from("images").upload(`${t}`,d,{cacheControl:"3600",upsert:!0});if(u)throw console.error("[Supabase Storage] Upload error:",u),u;console.log("[Supabase Storage] Upload successful, getting public URL");const{data:g}=p.storage.from("images").getPublicUrl(x.path);return console.log(`[Supabase Storage] Image uploaded successfully with ID: ${t}`),g.publicUrl}catch(c){throw console.error("[Supabase Storage] Error converting base64 to Blob:",c),new Error(`Failed to process image: ${c.message}`)}}catch(r){throw console.error(`[Supabase Storage] Failed to upload image ${t}:`,r),r}},async deleteImage(t){try{const{error:e}=await p.storage.from("images").remove([`${t}`]);if(e)throw e;console.log(`[Supabase] Image deleted from storage with ID: ${t}`)}catch(e){throw console.error(`[Supabase] Failed to delete image ${t} from storage:`,e),e}}},B={async migrateImages(t){try{const e=Object.entries(t).map(([a,o])=>({id:a,image_data:o,content_type:a.startsWith("banner")?"banner":"scanner",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:r}=await p.from("images").upsert(e);if(r)throw r;console.log(`[Supabase] Migrated ${Object.keys(t).length} images`)}catch(e){throw console.error("[Supabase] Failed to migrate images:",e),e}},async migrateContents(t){try{const e=t.map(a=>({id:a.id,title:a.title,description:a.content,type:a.type,image_id:a.imageId,position:a.position||0,scale:a.scale||1,created_at:new Date(a.createdAt).toISOString(),updated_at:new Date(a.updatedAt).toISOString()})),{error:r}=await p.from("contents").upsert(e);if(r)throw r;console.log(`[Supabase] Migrated ${t.length} contents`)}catch(e){throw console.error("[Supabase] Failed to migrate contents:",e),e}},async migrateUserSettings(t,e){try{const{error:r}=await p.from("user_settings").upsert({id:crypto.randomUUID(),user_id:t,settings:e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(r)throw r;console.log(`[Supabase] Migrated user settings for user ${t}`)}catch(r){throw console.error(`[Supabase] Failed to migrate user settings for user ${t}:`,r),r}}},Y=({size:t="md",color:e="primary",fullScreen:r=!1,text:a})=>{const o={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t],i={primary:"text-blue-600",white:"text-white",gray:"text-gray-600"}[e],c=s.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[s.jsx(y.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:s.jsxs("svg",{className:`${o} ${i}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),a&&s.jsx("span",{className:`text-sm font-medium ${i}`,children:a})]});return r?s.jsx("div",{className:"fixed inset-0 bg-gray-50/80 backdrop-blur-sm flex items-center justify-center z-50",children:c}):c},C=n.forwardRef(({children:t,variant:e="primary",size:r="md",isLoading:a=!1,loadingText:o,leftIcon:i,rightIcon:c,fullWidth:m=!1,disabled:l,className:d="",...x},u)=>{const g="inline-flex items-center justify-center font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors",h={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-gray-600 hover:bg-gray-100 focus:ring-gray-500"},f={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return s.jsx(y.button,{ref:u,whileTap:{scale:.98},disabled:l||a,className:`
          ${g}
          ${h[e]}
          ${f[r]}
          ${m?"w-full":""}
          ${l||a?"opacity-60 cursor-not-allowed pointer-events-none":""}
          ${d}
        `,...x,children:a?s.jsxs(s.Fragment,{children:[s.jsx(Y,{size:"sm",color:e==="secondary"||e==="ghost"?"gray":"white"}),o&&s.jsx("span",{className:"ml-2",children:o})]}):s.jsxs(s.Fragment,{children:[i&&s.jsx("span",{className:"mr-2",children:i}),t,c&&s.jsx("span",{className:"ml-2",children:c})]})})});C.displayName="Button";const ve=n.forwardRef(({children:t,size:e="md",...r},a)=>{const o={sm:"p-1.5",md:"p-2",lg:"p-3"};return s.jsx(C,{ref:a,size:e,className:o[e],...r,children:t})});ve.displayName="IconButton";const Ie=({onComplete:t})=>{A();const[e,r]=n.useState(1),[a,o]=n.useState(!1),[i,c]=n.useState(null),[m,l]=n.useState(0),[d,x]=n.useState(!1),[u,g]=n.useState({}),[h,f]=n.useState([]);n.useEffect(()=>{(()=>{const k=localStorage.getItem("admin_images");if(k)try{const S=JSON.parse(k);g(S)}catch(S){console.error("Failed to parse stored images:",S)}const $=localStorage.getItem("admin_contents");if($)try{const S=JSON.parse($);f(S)}catch(S){console.error("Failed to parse stored contents:",S)}const M=!!k||!!$;x(M),M||t()})()},[t]);const w=async()=>{if(!d){t();return}o(!0),c(null),l(0);try{r(1),Object.keys(u).length>0&&await B.migrateImages(u),l(50),r(2),h.length>0&&await B.migrateContents(h),l(100),t()}catch(b){const k=b instanceof Error?b.message:"Unknown error occurred";c(k),console.error("Migration failed:",b)}finally{o(!1)}},D=()=>{t()};return d?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:"Data Migration"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"We need to migrate your existing data to the new database system. This will ensure all your content is preserved."}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[s.jsx("strong",{className:"font-bold",children:"Error:"}),s.jsxs("span",{className:"block sm:inline",children:[" ",i]})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"relative pt-1",children:[s.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[s.jsx("div",{children:s.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200",children:a?`Step ${e} of 2`:"Ready to migrate"})}),s.jsx("div",{className:"text-right",children:s.jsxs("span",{className:"text-xs font-semibold inline-block text-blue-600",children:[m,"%"]})})]}),s.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200",children:s.jsx("div",{style:{width:`${m}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 transition-all duration-500"})})]})}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx(C,{variant:"secondary",onClick:D,disabled:a,children:"Skip Migration"}),s.jsx(C,{variant:"primary",onClick:w,isLoading:a,loadingText:"Migrating...",disabled:a,children:"Start Migration"})]})]})}):null},ke=({children:t})=>{const{currentUser:e}=A(),[r,a]=n.useState(!1),[o,i]=n.useState(!1),[c,m]=n.useState(!0),[l,d]=n.useState(null);n.useEffect(()=>{(async()=>{if(!e){m(!1),a(!0);return}try{const{data:g,error:h}=await p.from("images").select("id").limit(1);if(h)throw h;const f=localStorage.getItem("admin_contents")!==null;g.length===0&&f?i(!0):a(!0)}catch(g){console.error("[Supabase] Error checking Supabase setup:",g),d(g instanceof Error?g.message:"Failed to initialize Supabase")}finally{m(!1)}})()},[e]);const x=()=>{i(!1),a(!0)};return l?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-center p-4 max-w-md",children:s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[s.jsx("strong",{className:"font-bold",children:"Supabase Error:"}),s.jsxs("p",{className:"block sm:inline",children:[" ",l]}),s.jsx("p",{className:"mt-2 text-sm",children:"Please check your Supabase configuration in .env.local file."})]})})}):c?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Initializing application..."})]})}):s.jsxs(s.Fragment,{children:[o&&s.jsx(Ie,{onComplete:x}),r&&t]})},F=({children:t,requireOwner:e=!1})=>{const{currentUser:r,isLoading:a}=A(),o=R();return a?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"text-gray-600",children:"Loading..."})]})}):r?e&&!r.isOwner?s.jsx(E,{to:"/scanner",state:{error:"Owner access required"},replace:!0}):s.jsx(s.Fragment,{children:t}):s.jsx(E,{to:"/login",state:{from:o},replace:!0})},_e=()=>{const{theme:t,toggleTheme:e}=X();return s.jsx(y.button,{onClick:e,className:`
        fixed top-4 right-4 p-2 rounded-full
        flex items-center justify-center
        backdrop-blur-sm
        ${t==="dark"?"bg-gray-800/80 text-yellow-400 hover:bg-gray-700/80":"bg-white/80 text-gray-800 hover:bg-gray-100/80"}
        shadow-lg
        transition-colors
        z-50
      `,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Toggle theme",children:t==="dark"?s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})},_=({children:t})=>{const{currentUser:e,logout:r}=A(),{theme:a}=X(),o=te(),i=R(),c=async()=>{try{await r(),o("/login")}catch(l){console.error("Failed to log out:",l)}},m=l=>i.pathname.startsWith(l);return s.jsx("div",{className:`min-h-screen ${a==="dark"?"dark":""}`,children:s.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors duration-200",children:[s.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors duration-200",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"h-16 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center",children:s.jsx(y.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-2xl font-bold text-gray-900 dark:text-white",children:"COMET Scanner Wizard"})}),s.jsx(O,{mode:"wait",children:e&&s.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.isOwner&&s.jsx("span",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full text-xs font-medium mr-2",children:"Owner"}),s.jsx("span",{children:e.username})]}),s.jsx("button",{onClick:c,className:"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-sm font-medium transition-colors",children:"Logout"})]})})]}),e&&s.jsxs("nav",{className:"flex space-x-8 -mb-px",children:[s.jsx(z,{to:"/scanner",className:`border-b-2 py-4 px-1 inline-flex items-center text-sm font-medium transition-colors ${m("/scanner")?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"}`,children:"Scanner Templates"}),e.isOwner&&s.jsx(z,{to:"/admin",className:`border-b-2 py-4 px-1 inline-flex items-center text-sm font-medium transition-colors ${m("/admin")?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"}`,children:"Admin Dashboard"})]})]})}),s.jsxs("main",{className:"relative",children:[s.jsx(_e,{}),s.jsx(O,{mode:"wait",children:s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:t},"content")})]}),s.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 transition-colors duration-200",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["© ",new Date().getFullYear()," COMET Scanner Wizard"]}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Version 1.0.0"})]})})]})})},N=({message:t="Loading...",minDisplayTime:e=500})=>{const[r,a]=n.useState(!1);return n.useEffect(()=>{const o=setTimeout(()=>{a(!0)},100),i=setTimeout(()=>{},e);return()=>{clearTimeout(o),clearTimeout(i)}},[e]),r?s.jsx("div",{className:"min-h-[200px] flex flex-col items-center justify-center p-4",children:s.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},className:"flex flex-col items-center",children:[s.jsx(Y,{size:"lg"}),s.jsx(y.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.3},className:"mt-4 text-gray-600 dark:text-gray-400 font-medium",children:t})]})}):null},Ne=()=>{const[t,e]=n.useState(!1),[r,a]=n.useState([]);return n.useEffect(()=>{},[]),null},j=class j{constructor(){L(this,"listeners",[])}static getInstance(){return j.instance||(j.instance=new j),j.instance}addListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(r=>r!==e)}}notify(e){this.listeners.forEach(r=>r(e))}log(e,r,a,o){const i={id:Date.now().toString()+Math.random().toString(36).substr(2,5),timestamp:new Date,level:e,message:r,details:a,source:o};this.notify(i);const c=`[${o||"Debug"}] ${r}`;switch(e){case"info":console.info(c,a||"");break;case"warn":console.warn(c,a||"");break;case"error":console.error(c,a||"");break;default:console.log(`[${e}] ${c}`,a||"")}}info(e,r,a){this.log("info",e,r,a)}warn(e,r,a){this.log("warn",e,r,a)}error(e,r,a){this.log("error",e,r,a)}debug(e,r,a){this.log("debug",e,r,a)}image(e,r,a){this.log("image",e,r,a)}supabase(e,r,a){this.log("supabase",e,r,a)}state(e,r,a){this.log("state",e,r,a)}};L(j,"instance");let T=j;const qe=T.getInstance(),Ee=({maxLogs:t=50})=>{const[e,r]=n.useState(!1),[a,o]=n.useState([]),[i,c]=n.useState("all"),[m,l]=n.useState(""),[d,x]=n.useState(new Set);n.useRef(null);const[u,g]=n.useState(!0),[h,f]=n.useState([]);return n.useEffect(()=>{},[]),n.useEffect(()=>{},[t]),n.useEffect(()=>{},[t,u]),n.useEffect(()=>{},[]),n.useEffect(()=>{},[]),null},Ce=n.lazy(()=>v(()=>import("./Login-DiOkxBut.js"),__vite__mapDeps([0,1,2,3,4]))),Ae=n.lazy(()=>v(()=>import("./Signup-SUCIb6Mq.js"),__vite__mapDeps([5,1,2,3,4]))),De=n.lazy(()=>v(()=>import("./ScannerWizard-CBR4UT8n.js"),__vite__mapDeps([6,1,2,3,7,8,4]))),$e=n.lazy(()=>v(()=>import("./AdminDashboard-C0uz0YXK.js"),__vite__mapDeps([9,1,2,3,7,4]))),Le=()=>{window.addEventListener("load",()=>{setTimeout(()=>{v(()=>import("./Login-DiOkxBut.js"),__vite__mapDeps([0,1,2,3,4])),v(()=>import("./Signup-SUCIb6Mq.js"),__vite__mapDeps([5,1,2,3,4])),v(()=>import("./AdminDashboard-C0uz0YXK.js"),__vite__mapDeps([9,1,2,3,7,4]))},2e3)})};Le();function Oe(){return s.jsx(se,{children:s.jsx(ke,{children:s.jsx(H,{children:s.jsx(xe,{children:s.jsx(we,{children:s.jsxs(ye,{children:[s.jsx(Ne,{}),s.jsx(Ee,{}),s.jsxs(re,{children:[s.jsx(I,{path:"/login",element:s.jsx(_,{children:s.jsx(n.Suspense,{fallback:s.jsx(N,{message:"Loading login page..."}),children:s.jsx(Ce,{})})})}),s.jsx(I,{path:"/signup",element:s.jsx(_,{children:s.jsx(n.Suspense,{fallback:s.jsx(N,{message:"Loading signup page..."}),children:s.jsx(Ae,{})})})}),s.jsx(I,{path:"/scanner",element:s.jsx(F,{children:s.jsx(_,{children:s.jsx(n.Suspense,{fallback:s.jsx(N,{message:"Loading scanner wizard..."}),children:s.jsx(De,{})})})})}),s.jsx(I,{path:"/admin",element:s.jsx(F,{requireOwner:!0,children:s.jsx(_,{children:s.jsx(n.Suspense,{fallback:s.jsx(N,{message:"Loading admin dashboard..."}),children:s.jsx($e,{})})})})}),s.jsx(I,{path:"/",element:s.jsx(E,{to:"/scanner",replace:!0})}),s.jsx(I,{path:"*",element:s.jsx(E,{to:"/scanner",replace:!0})})]})]})})})})})})}const Te=()=>{J();const t=localStorage.getItem("user_ChasinAlts");if(!t)return console.error("Admin account initialization failed"),!1;try{const e=JSON.parse(t);return e.username!=="ChasinAlts"?(console.error("Admin username mismatch"),!1):e.isOwner?["contentManagement","userManagement","systemConfiguration","mediaUploads","securitySettings","siteCustomization"].every(o=>e.permissions[o])?!0:(console.error("Admin missing required permissions"),!1):(console.error("Admin is not set as owner"),!1)}catch(e){return console.error("Error verifying admin setup:",e),!1}};Te();ae.createRoot(document.getElementById("root")).render(s.jsx(oe.StrictMode,{children:s.jsx(H,{children:s.jsx(Oe,{})})}));export{_e as T,Re as a,X as b,Ve as c,qe as d,Ue as e,We as i,Je as s,A as u};
